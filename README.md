# 微博群消息发送工具

这是一个用 Go 语言编写的微博群消息发送工具，支持自动化登录和消息发送功能。

## 功能特性

1. **自动化登录**：使用 Chrome 浏览器自动化登录微博，并自动获取 Cookie
2. **群组搜索**：通过关键词搜索微博群组，无需手动查找群组 ID
3. **发送群消息**：通过微博 API 发送群组消息
4. **配置管理**：自动保存和管理登录信息，无需每次都重新登录
5. **交互式界面**：提供友好的命令行交互界面

## 安装要求

- Go 1.16 或更高版本
- Chrome 浏览器（用于自动化登录）

## 安装步骤

1. 克隆或下载本项目

2. 安装依赖：
```bash
go mod download
```

3. 编译程序：

**单平台编译（当前系统）：**
```bash
go build -o weibo-sender
```

**全平台打包：**
```bash
./pack.sh
```
会生成 `weibo-sender-all-platforms.zip`，包含：
- Windows (amd64)
- macOS Intel (amd64)
- macOS Apple Silicon (arm64)
- Linux (amd64)

## 使用方法

### 运行程序

```bash
./weibo-sender
```

### 使用流程

1. **自动检查登录状态**
   - 首次运行会提示登录
   - 按回车后自动打开 Chrome 浏览器
   - 在浏览器中完成微博登录
   - 登录成功后自动获取并保存 Cookie

2. **搜索群组**
   - 输入群组名称关键词（例如：测试）
   - 程序会显示所有匹配的群组列表

3. **选择群组**
   - 可以选择单个群组：输入编号，如 `1`
   - 可以选择多个群组：用逗号分隔，如 `1,2,3`
   - 可以选择全部群组：输入 `all`

4. **输入消息并发送**
   - 输入要发送的消息内容
   - 程序会自动向所有选中的群组发送消息
   - 每个群组之间会自动延迟 2 秒

5. **查看发送结果**
   - 程序会显示每个群组的发送状态
   - 最后显示成功和失败的统计信息

## 配置文件

配置文件自动保存在：`~/.weibo-sender/config.json`

配置文件包含：
- `cookies`：登录 Cookie 信息
- `source`：API 调用的 source 参数（默认：209678993）
- `send_delay`：发送延迟时间（秒），默认 2 秒

### 配置示例

```json
{
  "cookies": {
    "SCF": "...",
    "SUB": "...",
    "SUBP": "..."
  },
  "source": "209678993",
  "send_delay": 2
}
```

### 自定义发送延迟

如果需要调整发送间隔，可以编辑配置文件中的 `send_delay` 值（单位：秒）：

```bash
# 编辑配置文件
vi /config.json

# 修改 send_delay 值，例如改为 3 秒
{
  ...
  "send_delay": 3
}
```

## 项目结构

```
.
├── main.go           # 主程序入口
├── auth/
│   └── login.go      # 自动化登录模块
├── config/
│   └── config.go     # 配置文件管理
└── weibo/
    └── sender.go     # 消息发送模块
```

## 注意事项

1. 请确保已安装 Chrome 浏览器
2. 首次登录时需要手动完成验证码等安全验证
3. Cookie 有效期有限，过期后需要重新登录
4. 请遵守微博的使用条款，不要滥用此工具

## 常见问题

**Q: 登录后提示 Cookie 获取失败？**
A: 请确保在浏览器中完全登录成功，并等待页面完全加载后再关闭。

**Q: 发送消息失败，提示 401 或 403 错误？**
A: Cookie 可能已过期，删除配置文件后重新运行：`rm ./config.json && ./weibo-sender`

**Q: 找不到 Chrome 浏览器？**
A: 请确保已安装 Chrome 浏览器，并且在系统 PATH 中可以找到。

**Q: 如何调整发送间隔时间？**
A: 编辑配置文件 `./config.json`，修改 `send_delay` 值（单位：秒）。

**Q: 可以一次发送给所有群组吗？**
A: 可以，在选择群组时输入 `all` 即可选择所有搜索到的群组。

## 许可证

MIT License

